<!DOCTYPE html>
const despesasDoMes = useMemo(()=>despesas.filter(d => yyyymm(d.data) === mes), [despesas, mes]);
const totalMes = useMemo(()=>despesasDoMes.reduce((acc, d) => acc + d.valor, 0), [despesasDoMes]);
const porCategoria = useMemo(()=>{
const mapa = {};
for(const d of despesasDoMes){
mapa[d.categoria] = (mapa[d.categoria] || 0) + d.valor;
}
return mapa;
}, [despesasDoMes]);


function adicionarDespesa(nova){ setDespesas(prev => [nova, ...prev]); }
function excluirDespesa(id){ setDespesas(prev => prev.filter(d => d.id !== id)); }


function adicionarCategoria(){
const nome = prompt('Nome da nova categoria:')?.trim();
if(!nome) return;
if(categorias.includes(nome)) return alert('Categoria já existe.');
setCategorias([...categorias, nome]);
}


function limparTudo(){
if(confirm('Tem certeza que deseja limpar TODAS as despesas?')){
setDespesas([]);
}
}


return (
<main className="space-y-6">
<Header />


<section className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
<FiltroMes mes={mes} setMes={setMes} />
<div className="flex gap-2">
<button onClick={adicionarCategoria} className="border px-3 py-2 rounded-xl">+ Categoria</button>
<button onClick={limparTudo} className="border px-3 py-2 rounded-xl">Limpar tudo</button>
</div>
</section>


<NovaDespesaForm onAdd={adicionarDespesa} categorias={categorias} />


<CartoesResumo totalMes={totalMes} porCategoria={porCategoria} />


<section className="bg-white rounded-2xl shadow p-4 space-y-3">
<h2 className="text-xl font-semibold">Despesas do mês</h2>
<TabelaDespesas itens={despesasDoMes} onDelete={excluirDespesa} />
</section>


<footer className="text-center text-xs text-slate-400 pt-4">
Feito com React + Tailwind. Seus dados ficam somente no seu navegador (localStorage).
</footer>
</main>
);
}


const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>
